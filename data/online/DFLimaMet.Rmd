```{r include=FALSE}
library(ggplot2)
library(ggrepel)
library(plotly)
library(scales)
library(ggpubr)
```

#Candidatos y Actores Politicos en Lima Metropolitana 2018 en Twitter

###Crecimiento de followers: 

```{r include=FALSE}
data=read.csv("dataAfertdep.csv")
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
g <- ggplot(data=data,
        aes(x=reorder(candidato, Nuevos_Followers1), y=Nuevos_Followers1,group=1)) +
  geom_bar(stat="identity") + xlab("") + ylab("Nuevos Followers")+
    theme(text = element_text(size=9))+ coord_flip() + ggtitle("Entre 01/09 al 23/09 (antes debate 1)") +
  ylim(0, 4000)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
d <- ggplot(data=data,
       aes(x=reorder(candidato, Nuevos_Followers2), y=Nuevos_Followers2,group=1)) +
  geom_bar(stat="identity") + xlab("") + ylab("Nuevos Followers")+
    theme(text = element_text(size=9))+ coord_flip() + ggtitle("Entre 24/09 al 29/09 (antes debate 2)")+
  ylim(0, 4000)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggarrange(g, d ,
          ncol = 2, nrow = 1)
```

###Crecimiento de followers e intención de voto

Crecimiento antes y después del debate: 

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data[data$setiembre >0,], aes(x=Nuevos_Followers2, y=setiembre, size=following_afdeb, color=antiguedad)) + geom_point() + ggtitle("Han crecido los candidatos en la red luego del debate?") + ylab("% Intencion de voto") + xlab("Nuevos Followers") + 
  geom_label_repel(aes(label = candidato),
                  box.padding   = 0.3,
                  segment.color = 'grey50',
                  size=3) + scale_size(labels = comma)  + 
scale_color_gradient(low = '#fcae91', high = '#a50f15') + theme(
panel.grid.minor = element_blank() 

)

```

```{r echo=FALSE, message=FALSE, warning=FALSE}

x <- data[data$setiembre >0,]$candidato
hovertxt <- paste("Candidato:", x)

graph <- ggplot(data[data$setiembre >0,], aes(x=Nuevos_Followers2, y=setiembre, size=following_afdeb, color=antiguedad,text = hovertxt))+ geom_point() + ggtitle("Han crecido los candidatos en la red luego del debate?") + ylab("% Intencion de voto") + xlab("Nuevos Followers") + 
scale_color_gradient(low = '#fcae91', high = '#a50f15')

p <- ggplotly(graph)

p
```
