```{r include=FALSE}
library(ggplot2)
library(ggrepel)
library(plotly)
```

#Candidatos y Actores Politicos en Lima Metropolitana 2014 en las redes sociales

```{r include=FALSE}
data=read.csv("DFLimaMet.csv")
```

```{r include=FALSE}
head(data)
```

```{r include=FALSE}
colnames(data)= c( "candidato", "alias" ,"followers", "following", "antiguedad", "aÃ±o", "meses", "agosto", "setiembre")
```


```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data[data$setiembre >0,], aes(x=antiguedad, y=setiembre, size=followers, color=following)) + geom_point() + ggtitle("Utilizan twitter los candidatos con mayor intencion de voto en Lima?") + ylab("% Intencion de voto") + xlab("Tiempo en twitter (years)") + 
  geom_label_repel(aes(label = candidato),
                  box.padding   = 0.3,
                  segment.color = 'grey50',
                  size=3) + 
scale_color_gradient(low = '#fcae91', high = '#a50f15') + scale_y_continuous(breaks = seq(0,20,5)) + scale_x_continuous(breaks=seq(0,8,2)) + xlim(0,8) + ylim(0,20)  + theme(
panel.grid.minor = element_blank()
)

```

```{r echo=FALSE, message=FALSE, warning=FALSE}

x <- data[data$setiembre >0,]$candidato
hovertxt <- paste("Candidato:", x)

graph <- ggplot(data[data$agosto >0,], aes(x=antiguedad, y=setiembre, size=followers, color=following,text = hovertxt))+ geom_point() + ggtitle("Utilizan twitter los candidatos con mayor intencion de voto en Lima?") + ylab("% Intencion de voto") + xlab("Tiempo en twitter (years)") + 
scale_color_gradient(low = '#fcae91', high = '#a50f15') + scale_y_continuous(breaks = seq(0,20,5)) + scale_x_continuous(breaks=seq(0,8,2)) + xlim(0,8) + ylim(0,20) 

p <- ggplotly(graph)

p
```




